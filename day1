#######################operating system basics ##########################

range-isms, are called out periodically in lessons to remind you of their presence. You must ignore or avoid interacting with these items.
interacting with them may cause the range to fail and require a redeployment. Some of these range-isms include:
..........
The 10.0.0.0/8 subnet is used for range management and configuration.
WARNING: Do not interact with this subnet or it may cause an error in the range.There are several files, directories, and processes that are related to normal range operation. 
These items are off-limits and should not be interfered with. If uncovered within the context of an investigation, these items can be safely ignored, as they are not relevant to 
the investigation.
systeminit.exe and all files related to this binary
java.exe listening on port 49999 and 49998 
java.exe communicating over port 5762, 15672, & 27017
Advanced Message Queuing Protocol (AMQP) listening on port 5672
Software or files located in C:\Program Files (x86)\Lincoln\
Software or files located in C:\ProgramData\staging\
Software or files located in C:\Program Files\Puppet Labs\
Software or files located in C:\ProgramData\PuppetLabs\ 
Software or files located in C:\Program Files (x86)\SimSpace\
ruby.exe on Windows and ruby on Linux


-----------------------------kernel and user modes-----------------------------
There are two modes of operation built into a system’s CPU: user mode and kernel mode.

 kernel:  kernel mode, the code being executed by the CPU has unrestricted access to all of the system’s hardware. 
          This access includes the ability to execute any CPU instruction and access any memory address

user:     user mode, the code being executed can only run a limited set of safe instructions


----------------system calls & Libray calls ---------------------------------

example: example, a program needs access to the system’s memory and CPU in order to execute, and may also require the ability to read or write files to disk, send data across a network link, 
or communicate with an external peripheral device. In order to solve this problem, client applications must ask the OS for help by making a system call (or syscall)

difference between system calls and library calls. A library is a software module that implements some functionality and makes that functionality available to other programs by exposing it through an interface.
For example, most OSs and programming languages are shipped with an embedded networking library

----------------------Protection Rings---------------------------
rings 0-3
ring 0: ring 0 represents the operations with the highest privileges over the system (CPU kernel mode operations)
ring 3: ring 3 is used to represent CPU user mode operations

------------------------------the kernel-------------------------------

 kernel is the aptly-named central component of the OS. During the system’s boot process, the kernel program is loaded into a protected area of memory and remains loaded as long as the system is powered on.
 Unsurprisingly, most kernel code executes in kernel mode within the CPU.

kernel capabilities
- Process management
- Memory management
- File management
- Peripheral and Input/Output (I/O) device management
- Security management

------------------------------Process Structure in Memory--------------------------------------

- Text: Contains the machine instructions loaded from the executable. This is the actual set of instructions that the CPU executes.
- Data: Stores any variables that were initialized by the programmer or compiler. The initialization process requires the compiler to know 
  how much memory is needed to store the variable, as well as the initial, non-zero value of the variable.
- BSS: Used to store variables that have been instantiated, but not initialized. 
- Heap: Used to dynamically allocate memory for variables whose sizes cannot be known until runtime,
- Stack: Last In, First Out (LIFO) data structure used to store stack frames, which contain information about the current  execution sta te of the process.
  If a process has multiple threads, each thread is given its own stack.


-------------------Lifecycle of a Process-------------------------

There are five main states that a process can be in, though specific OSs may use more granular states than those described.

- When in the Created or New state, processes are waiting to be loaded into main memory (Random Access Memory [RAM]). The OS has not yet allocated system resources to the process, 
  or is just beginning to allocate these resources.
- A process in the Ready or Waiting state has been fully loaded and is waiting to be scheduled for execution. Multiple processes are generally in this state at a given time.
- A Running process is one that is currently running on one of the CPU’s hardware cores, in either kernel mode or user mode. Processes scheduled to run in the CPU do so for a short while,
  before being swapped out with another process that is in the Ready state. A Running process that is swapped out of the CPU generally returns to the Ready state.
- A Blocked process is waiting for an event that is outside of its control to occur. For example, a process that is waiting for an incoming network connection might be in the Blocked state while 
  it waits for the connection to occur. Upon receiving the connection, the OS moves that process from Blocked to Running so it can handle the incoming connection.
- A Terminated process has completed its execution, or was explicitly killed by some other process or system action. Killing a process is a common phrase when discussing process termination.






------------Process Identifiers--------------------
process is created — also referred to as spawning a process — the OS assigns that process a number in order to identify that process within the system. This number is known as a PID.
                   note about PIDs is that they are unique only for currently executing processes within a single system — two different systems may assign the same PIDs to different processes,
                        and a system may reuse a PID if it is not currently being used.

kill command: the kill command can be used to terminate a process on a Linux machine, but must be given the PID of a process in order to take action upon it.



----------------------Process Trees---------------------------


Daemon processes

 root process is responsible for loading every other process necessary for the system to function. Usually, 
the root process delegates some of these responsibilities by spawning other processes known as daemon processes,
or daemons, which manage certain components across the entire OS

           - On Windows machines, daemon processes are referred to as services



-----------------------Windows | Core Processes----------------------
in class we worked in vm and ran commands tasklist in windows vm.
command :C:\Users\trainee>tasklist

-------------------------Core Processes | Linux---------------------

in class we worked in vm and ran commands tasklist in linux vm.
command ps -Hwwfe


--------------------Memory Management--------------------------

During process creation, the kernel allocates memory to a process — this memory contains the stack, heap, data, text, and BSS sections as described earlier. 
The kernel is responsible for managing the usage of most of this memory during the lifecycle of the process.When a process terminates,the kernel is responsible for deallocating and
memory that was used by the process,freeing it up to be reallocated to other processes.





-------------------Virtual Memory------------------------

Virtual memory is a memory management technique used by modern OSs in order to more effectively manage and secure this key system resource. During process creation, 
a program and any system libraries it relies on are loaded into the process’s virtual memory. When this process later needs to access or change data held in its virtual memory, 
it does so via a virtual memory address — the location of the data in its virtual memory. Dedicated hardware known as the Memory Management Unit (MMU) 
translates these virtual memory addresses into physical memory addresses — actual locations within physical memory such as RAM. To the process, its virtual memory is
always present and is always arranged contiguously. 


-----------------------Memory Paging------------------------

Using a virtual memory scheme, an OS can allocate a sizable chunk of memory to each process running on it. Usually, the amount of memory allocated to each process is a significant
portion of the system’s actual physical memory — RAM, in this case.

how it works : Memory paging or memory swapping refers to a technique where inactive virtual memory is saved to a secondary storage device, such as a hard disk, when it is not in use.

certainly can provide increased efficiency and speed across a system, there are instances where the amount of overhead far outweighs the benefits conferred

Windows stores all inactive memory pages inside a page file named pagefile.sys. The default location of this file is located in the root directory of the disk (i.e., C:\pagefile.sys).

Linux instead uses the term swap space to refer to the locations on the disk where inactive memory pages (also known as swap files) are stored. 


------------------------File Management---------------------

defines a format for organizing, storing, and tracking files. To do this, the filesystem tracks some metadata information about each file, 
in addition to that file’s actual contents. The tracking of this metadata is done within a record for each file present within the filesystem
filesystems maintain a directory to quickly look up the record of each file in the filesystem. A filesystem's directory and list of records exist
in a reserved portion of the filesystem. Many filesystem implementations exist; they differ in size, speed, security, functionality, and other factors

-------------------------Filesystem Internals------------------------------

When the kernel receives a request to access a file, it searches through the filesystem’s directory for the appropriately named file, using the directory to determine 
the location of that file’s associated record in a record list. From the file’s record, the kernel can retrieve metadata information about the file, which includes 
the physical location of the file’s raw data held within the computer’s hard drive.

-----------------------Metadata in Filesystems--------------------------------

Filesystem metadata is stored within a file’s record. This metadata may include the file’s physical location on disk, its size, any associated permissions, and a set of timestamps describing when
a file was last modified, accessed, or created. Different filesystem implementations keep track of different metadata information

Filesystem metadata is a fantastic source of information about the system. Later in this lesson, filesystem metadata is used as an evidence source for a simple investigation.

-------------------------Virtual Filesystems------------------------------

Virtual Filesystem (VFS) is an abstract layer that lies between client applications and the concrete filesystem. A VFS is usually implemented as a kernel module within the OS kernel, 
and defines a common language that client applications and filesystems can use to communicate, regardless of the specifics of the underlying filesystem. 


----------------Types of Filesystems--------------------------


Windows Filesystems 
-------------------
File Allocation Table (FAT):  basic filesystem that uses a specific construct to reference files stored on a disk. FAT comes in several variants, the oldest of which,
                              FAT8, has been around since the 1970s. FAT12, FAT16, and FAT32 are updated versions of the FAT filesystem, and support increasingly larger disk 
                              sizes, single file sizes, and longer filenames

New Technology File System (NTFS): developed by Microsoft to replace FAT in Windows NT 3.1. NTFS has undergone several revisions during its lifetime, and provides several enhancements
                                   to filesystem performance, efficiency, capacity, resilience, and security. NTFS is still the most common filesystem in use on Windows OSs.

                                   can more easily deal with problems caused by unintended interruptions, such as a power outage.

                                   big reason behind the change from FAT to NTFS is that NTFS natively implements security mechanisms that allow for access controls to be applied directly within the 
                                   filesystem. NTFS contains two Access Control Lists (ACL), which are associated with each file or directory; the Discretionary Access Control 
                                   List (DACL) and the System Access Control List (SACL)

DACL: DACL is responsible for implementing basic permissions that define which users and/or groups can perform actions, reading, writing, execution, or deletion of a file or folder
SACL: SACL is responsible for determining how the system should audit attempted actions being performed against a file or folder as well as whether those actions succeeded or not.

MFT: Metadata about files and directories within an NTFS are stored in a database known as the Master File Table (MFT), which also serves as the directory for the filesystem. The MFT is an extremely
     important evidence source that can be utilized to investigate a system that uses NTFS.

---------------------------Resilient File System----------------------------

Resilient File System (ReFS) is another filesystem developed by Microsoft, intended to be the next generation Windows filesystem
to replace NTFS. According to Microsoft, ReFS was designed to maximize data availability, scale efficiently to large data sets 
across diverse workloads, and provide data integrity with resiliency to corruption




------------------------Extended Filesystem----------------------------
Extended Filesystem (ext) was created one year after the initial release of the Linux OS. Soon after, ext2 was released and quickly became the default filesystem 
for use in most Linux distributions. The ext3 filesystem was the first in the ext line to implement journaling capabilities, and ext4 further expanded the functionality
provided by ext3. Improvements in ext4 consisted of large filesystem support, improved resistance to fragmentation, higher performance, and improved timestamps



------------------------XFS----------------------------
XFS is the default filesystem for Red Hat Enterprise Linux — a common Linux distribution. It offers similar features to ext4


--------------------------ZFS--------------------------
ZFS is considered a next-generation filesystem because of several fundamental changes in its approach to storage volume management. 
According to Wikipedia, ZFS was designed with a focus on data integrity, and offers several highly-advanced features that meet this design goal


---------------------Index Nodes-------------------------------

Linux kernel supports a large variety of filesystems compared to other OSs. This is because of a construct called the index node (inode) that exists 
as an abstraction layer within the Linux kernel. Inodes are an integral part of the Linux kernel; all file management behavior within Linux OSs deals directly 
with these inodes, requiring only that the Linux VFS perform small translation steps between the Linux kernel and the underlying concrete filesystem.

The behaviors made available by inodes include the creation of hard links and symbolic links, which themselves can be used in fairly interesting ways.


-----------------------Hard Links---------------------------------

When a regular file is created on a Linux machine, the filesystem creates a new record for the file within its record list,
and provides a unique ID number back to the Linux kernel. The kernel uses this ID number as the inode ID; the inode ID number is used by the 
kernel to perform operations against the file located on the filesystem.

Making a hard link to a file creates a new file as normal, but instead of its own inode, the hard link directly references 
the inode of a different file. Follow the steps below to explore the properties of hard links

commands hard link: 
cd ~/tmp
echo "Hello, world." > regular_file
ln regular_file hard_link_example
cat hard_link_example
stat regular_file
stat hard_link_example
rm ~/tmp/regular_file
cat hard_link_example

------------------------Symbolic Links----------------------------

Symbolic links, also known as symlinks or softlinks, reference a file by that file’s name and location on the filesystem, rather than its inode value.
Advantages of symlinks include creating a link to directory locations, and to files or directory locations located on a completely different filesystem.

Unfortunately, symlinks do have a drawback; because a symlink does not reference an inode value, moving or deleting the target of the symlink 
breaks the symlink.

commands symbolic link: 
rm ~/tmp/hard_link_example ( from hard link commands)
echo "Hello, world." > regular_file
ln -s regular_file symlink_example
stat regular_file
stat symlink_example
cat symlink_example
rm ~/tmp/regular_file
cat symlink_example
echo "Catch you later, world!" > regular_file
Run the ls command to verify that the file was created successfully.

------------------------Symlink Chains---------------------------------------
symlinking to a file that is already symlink basiclly 

---------------------Network Management-----------------------------

Network devices or network interfaces are specialized hardware peripherals that enable the transmission of data between two or more systems.
In modern systems, basic networking interfaces are usually built directly into that system’s hardware. 


------------------Sockets---------------

A socket is a virtual construct that acts as the endpoint for a communication link on the system. Many sockets can be open on the system at a given time.
A client application that is running on the system can request a socket from the kernel, and use system calls to read or write data to the socket.

Socket System Calls:
- bind: The application requests the kernel to bind a previously instantiated socket to a network port or to a local file.
- isten: The application puts the socket into a listening state, meaning that the client application using the socket is actively ready to handle incoming connections
- accept: The application accepts an incoming connection to a listening socket. 
- connect: The application uses the socket to establish a connection with a different listening socket, which may be on the local system or located on some external network.
- recv or recvfrom: Short for receive. The application reads data from the socket. The recv syscall can be used as a shortcut by certain applications that have already established 
  a connection with another socket; recvfrom is used otherwise.
- send or sendto: The application sends data over the socket, which is transmitted to the corresponding socket on the other end of the connection. The send syscall is used as a shortcut
  by certain applications that have already established a connection; sendto is used otherwise
- The application closes the established connection. This may be performed by the listening socket or the connecting socket, and is mainly needed to close TCP connections; 
  UDP communications do not maintain the concept of a connection, so there is nothing to close.

Exploring Socket Connections:
commands:
nc -v -l -s localhost -p 10000
nc localhost 10000
netstat -ntu
ss -ntu
ifconfig

--------------Additional Kernel Capabilities---------------------

The kernel capabilities described below do not necessitate as much detail as the other capabilities you just reviewed. 

---------------------Security Management-----------------------

Security management is handled by a kernel component known as the security subsystem or security kernel. This portion of the kernel implements basic security procedures within the system.

-----------------Kernel Drivers---------------------

As stated earlier, the minimum capability required for a kernel to operate is the ability to facilitate the execution of software instructions on the system’s hardware.


------------------------Everything is a File-------------------------

Unix-like OSs are built with the idea that everything is a file. While this is not true in the literal sense, it speaks to an embedded feature of various Unix-like OSs — many system resources 
are exposed to the system’s applications via file descriptors. These file descriptors allow other applications to interact with a large variety of different resources in the same way that 
they would interact with a regular file.

----------------------Types of Kernels---------------------------

Linux uses a monolithic kernel approach — the entire OS was designed to run in kernel mode. In contrast, Windows uses a hybrid kernel approach — the OS was designed such that many 
larger components, such as the environment subsystems and OS-integral subsystems, run in user mode.

A third approach, known as the microkernel approach, is utilized by some other OSs. The microkernel approach moves as much functionality as possible into user mode execution — except for a very small core kernel.


-------------------------Windows Registry----------------------------------

Windows OSs make use of a construct called the registry to store system and user configuration information. The registry is a hierarchical database that stores information in key:value pairs, 
persists through system reboots by being saved to the system’s hard disk, and quickly referenced by both user mode and kernel mode processes running on the system. 

navigate when using regedit: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\RegisteredOwner registry key
                             HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList
                             HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles.

Profilelist:
folders listed under the ProfileList folder represent the different users located on the system. Within the Windows OS, user accounts are assigned a unique Security Identifier (SID) 
that is used to identify their user profile across the system. The first three SIDs are present on all modern Windows systems; they represent users that are used by the OS to launch
certain system services and OS-level tasks. Regular user accounts with no special OS use begin with S-1-5-21.

Profiles key:
Profiles key contains a list of Globally Unique Identifier (GUID) values, which are present throughout the Windows OS. Windows uses GUIDs to refer to unique objects within the system, 
though GUIDs are not guaranteed to be unique across systems. In this case, each GUID represents a different network profile that this machine has been connected to. 

-------------------Linux Configuration Files------------------------

Unix-like systems are stored as files. These files are known as configuration files, and are used similarly to the Windows registry in order to control how
a system or application functions. Configuration files are commonly located within the system’s /etc directory 

/etc/hosts file is used by the machine to shortcut the process of translating domain names into IP addresses, which is normally done via a separate network
request. If a domain name and IP address pair is included in the /etc/hosts file, the system can perform the translation itself without performing this 
additional network request.

commands used in VM: 
cat /etc/hostname
cat /etc/hosts
cat /var/log/journal/45627726134a433098b9c96c49beda8c/user-1003.journal
journalctl --user

--------------------------OS Fundamentals | Conclusion-------------------------




---------------------Forensic Principals-------------------------------
forensics involves the investigation of evidence sources left behind at the scene of a crime, in order to piece together additional information about that crime.

crime occurs in relation to a computer system, it requires special investigative techniques that fall under the umbrella of digital forensics. True digital forensics 
is more frequently found in law enforcement or federal investigations, which ultimately strive to identify, arrest, and prosecute the perpetrator(s) of a crime. 


Stages of Digital Forensics:
- Identification of evidence sources
- Preservation of evidence sources
- Acquisition of data from evidence sources
- Analysis and interpretation of the acquired data
- Presentation of the analysis results

------------------------chain of custody------------------------
procedures are collectively known as chain of custody and are crucial in order to prove that evidence being presented in court has not been altered
or tampered with in any way. Failure to follow chain of custody could entirely invalidate the results of an investigation and subsequent trial, 
and may lead to the unsuccessful prosecution of an otherwise guilty offender.


----------------------File Forensics--------------------------
Much of digital forensics activity is concerned with recovering evidence stored in files within a computer system. In some cases, files are freely 
available on the filesystem, and an investigator simply needs to locate them and identify whether their contents are relevant to the investigation.
In other cases, investigators must attempt to reconstruct deleted files. In both of these cases, investigators may further need to prove that a 
file is relevant to the investigation



----------------------File Carving--------------------------

File carving is the process of reconstructing files by scanning the raw bytes of a disk, and attempting to piece together the files without the metadata 
information normally tracked by the filesystem. File carving may need to be performed during forensic investigations by law enforcement or government 
agencies, or during data recovery operations. Usually, file carving requires determining the type of filesystem represented by the data on the disk, 
then using this knowledge to locate and reconstruct the directory and record list held within the filesystem.



----------------------Metadata---------------------------
Metadata can be simply defined as data about data. Metadata is extremely valuable to an investigation, because it can be used to develop additional inferences about data.

The most common types of metadata that are relevant to file forensics include:
- Creation date and time
- Program or processes used to create the data
- Data creator or author
- Technical standards used Location on a device where the data was created
- File size
- Data source 
- Data quality
- File modifications or programs used to modify


Windows OS utilizes the NTFS filesystem. NTFS keeps track of four timestamps for each file record stored in the filesystem’s MFT. Three of these are accessible from the Properties tab.

- File Created: The date on which the file was first created on the filesystem. 
- File Accessed: The most recent time the file was accessed. Moving, opening, or reading metadata information about a file is considered an access and causes this value to change.
- File Modified: The most recent time that the file’s contents were modified. 
- MFT Last Written: The most recent time that the file’s record within the MFT was updated. This timestamp is not included within the standard Windows interface, 
                    and necessitates direct inspection of the MFT record, usually via a forensics tool.

------------------------Exchangeable Image File Format Data----------------------------------------

As demonstrated, even simple metadata can be extremely useful during an investigation. The steps below introduce Exchangeable Image File Format (EXIF) data,
which is commonly embedded within pictures. Criminal investigations that involve photographs can make good use of EXIF data, since it normally contains 
information such as the following:
- Camera make and model used to take the picture
- Geographical coordinates of where the picture was taken
- Editing software used to manipulate the picture
- Image dimensions

commands :
exiftool ~/Documents/stuff/DSCN0038 : gives alot of images info
stat ~/Documents/stuff/DSCN0040 : gives little info : Access: The most recent time the file’s contents were accessed
                                                      Modify: The most recent time the file’s contents were modified
                                                      Change: The most recent time the file’s record was changed within the filesystem
                                                      Birth: The original time the file was created

------------------------File Headers------------------------

ile header is a chosen location, usually found at the beginning of a file, which is used to store metadata specific to a given file format.
File headers and file formats are intended to help systems and applications handle any operations that need to be performed against that file format.


------------------------Portable Executable Format------------------------

 Portable Executable (PE) format is a common file format across many types of executable files on Windows systems.
The PE format contains a compiled executable program, along with instructions for how the OS should load that program into memory. The most common file types that make use of the PE format are:

- Stand-alone executables (.exe)
- Dynamic-link libraries (.dll)
- Device driver files (.sys)
- Control panel items (.cpl)

-----------------------PE Structure---------------------------
PE Structure


All PE files begin with the following three sections.
DOS HeaderDOS was the precursor to the Windows OS. Windows continued to rely on certain portions of DOS until the release of Windows XP, so executable code had to play nice with DOS. 
The DOS header is still present in all PE files today. DOS StubA stub is a small program or piece of code that is executed by default when an application's execution begins.
For Windows executables that cannot be run on DOS systems, an error message This program cannot be run in DOS mode. is printed.
PE File HeaderThis contains the actual start of the PE file, which begins telling the OS how to load the rest of the executable code into memory.

 note that the DOS header starts with the characters MZ, and the PE header starts with the characters PE. The error message within the DOS stub is also clearly visible.
If you are able to locate these three items at the start of an unknown file, it is almost certainly a PE file.

---------------------Indicators of Compromise---------------------------
Indicators of Compromise (IOC) are forensic artifacts that serve as evidence that an intrusion has occurred within a host or network. File metadata sometimes contains 
IOC information that can aid a forensic or security investigation.

PE headers can be parsed by several applications, including Windows’s default Right-click > Properties window.

Other common IOCs used to aid security investigations include various network artifacts, such as IP addresses, domain names, 
and patterns located in web Uniform Resource Locators (URL). 

-------------------------------File Hashes-----------------------------------
 file hash is a unique value that is calculated by running a file’s contents through a hashing function. Manipulating even one bit of a file is enough to change
the entire resulting hash value, making file hashes incredibly useful for forensic and security investigations. Locating a file hash associated with a known malicious
file is strong evidence that MCA has occurred. Hashing functions are also commonly used in many modern cryptographic algorithms.

several different hashing functions in current use. Commonly-encountered hashing functions include Message Digest (MD) 5, Secure Hash Algorithm (SHA) 256, SHA512, 
and SHA1. Figure 1.1-97 shows the Get-FileHash PowerShell cmdlet being used to calculate the SHA256 hashes of two files on a Windows machine. 
(The sha256sum command can be used to calculate SHA256 file hashes on Linux machines.)

Weaknesses have been discovered in certain hashing functions that mean that hash collisions are possible, though it is extremely unlikely. A hash collision occurs
when two files with different contents generate the same hash. 

Hash collisions have dangerous implications for any cryptographic algorithms that rely on those hashing functions.


--------------------Registry Autorun Keys------------------------
Registry Editor, navigate to the following registry path:
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run

-------------------Examining the Suspicious PE--------------------------
did in class on VM

commands:  Run the Get-FileHash command against the original FlashPlayerUpdate.exe file.
Get-FileHash FlashPlayerUpdate.exe

####################### end of operating system basics ##########################

#################### scripting Primer ########################

--------------------------Scripting Languages Used in This Course----------------------


This course uses the following scripting languages, which come with their own pros and cons:
- windows
- batch files
- PowerShellBash
- Python

Windows batch file format is usable on all modern versions of Windows. (for batch files end in .bat or .cmd)

PowerShell is a .NET-based, cross-platform scripting solution that has native support for remote execution and is deployed by default on modern versions of Windows
features that enable richer scripts, such as full support for object-oriented programming, creation of new cmdlets — small commands or scripts written for PowerShell,
which typically return a .NET object  (filenames end in .ps1, however, other files used in PowerShell can have other extensions.)

Bash scripting is typically used on Unix-like systems, such as Linux, MacOS, Berkeley Software Distribution (BSD), 
Bash can be deployed to Windows systems through Windows Subsystem for Linux (WSL), Cygwin, or other similar tools
( typically have a filename ending in .sh, though this is by convention only, and is not required. Adversaries often choose not to use this file extension.)
Z Shell (ZSH) and other shells on Unix-like systems often have fairly similar scripting environments that may be mostly compatible with Bash scripts. Shell scripts ( zshell is like new version )

Python is a programming language often use in scripting. It is cross-platform, and often installed on Unix-like operating systems as well as being deployed on Windows workstations and servers where it is a dependency. 
 has a rich package system available with pip. (Python scripts traditionally end in .py, however, this is not necessary and an adversary can choose not to use this file extension.)

------------------------Script Editing--------------------------------

 features that can help make the creation of scripts easier, such as:

- Syntax Highlighting: Changes the color of text to indicate the category of item that is represented by that text.
- Autocompletion: Allows the editor to provide probable completions to the text currently being entered (based upon the syntax of the scripting language in use), which can speed up development.
- Debugging: Allows the pausing of execution of a script or program to view the current state of the environment or manually direct program flow.
- Script Execution via Hotkey: Executes the script being edited via selecting a button or hotkey, allowing for more rapid execution and development.

Throughout this course, the following editors may be used (not exhaustive):

- Notepad: A simple text editor included in Windows by default; only supports editing.
- Gedit: The default editor for Gnome; included by default on some Linux distributions. Supports editing and syntax highlighting for any included languages.
- Nano/Pico: A simple, easy to use command line text editor, commonly available or able to be installed on Unix-like machines. Only supports basic editing, however it may support some syntax highlighting.
- PowerShell ISE: Integrated into some versions of PowerShell; supports all these features and many more, such as block code execution (executes a highlighted block of code) and help files for PowerShell features.
- Sublime Text: Included on some machines used during this course; supports syntax highlighting for some scripting languages, and limited autocompletion. Plugins may be available to support other features.
- Notepad++: An open-source text editor with many features similar to Sublime Text. Supports highlighting for some languages, and supports additional languages via plugins or editing the configuration.
- Visual Studio Code: This editor behaves as a full-blown Integrated Development Environment (IDE) for many languages — either natively or via plugins. It supports many features to assist development, 
  such as syntax highlighting, autocompletion, debugger support, and many hotkeys and configurations to assist development.
- Vi/Vim: While this command line text editor has rich configuration support, if used during this course, it is generally used as a basic text editor. 

--------------------------Reviewing and Executing an Existing Script---------------------------------

-eq is a comparison operator that returns true if the value on the left and right are equal. More comparison operators are covered later in this lesson.
param() is used at the top of a script to indicate named parameters that this script accepts. If no parameter is passed in, the value of the variable is $null.
while() a while loop continues executing until a specific condition is no longer met (i.e., until the expression being evaluated returns false). 
:: is used to execute static methods of .NET classes. In this case, the [string] class has a method named 
IsNullOrEmpty that checks if a supplied string is null ($null) or a string with no characters.
read-host is used to read input from the console with an optional prompt.





---------------------Execution History-------------------------


Many consoles or terminals store execution history. This can be a useful artifact when performing forensics or for sensors to read. While a malicious actor 
can often trivially clear the history on a machine, if this log is present, it can still be a useful artifact to be examined.

Bash’s history file is present at <userhome>/.bash_history

owerShell — since 5.0 — has a default location at %APPDATA%\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt.

C:\windows\temp\mw1.ps1
binary path
mw1.ps1 is the binary.
C:\windows\temp\ is the path.


--------------------persistence--------------------

persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other
interruptions that could cut off their access. In the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK)
framework, which is used in this course, this has an Identifier (ID) of TA0003. 

the MITRE ATT&CK framework, this corresponds to T1547.001 — Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder
— which consists of multiple readily-detectable methods usable by attackers on Windows.

-----------------Script Creation---------------------

When creating or prototyping a new script, there are many methods for determining the best path forward, however these methods generally boil down to:

- State the problem clearly. This step is vital to ensure that the correct solution is sought out.
- Determine a big picture solution to the problem.
- Break the solution down into individual steps that can be performed. If unable to do so, reconsider the solution or research as necessary.
- Determine how to perform each step in the target language, adjusting overall flow or structure as required based upon feedback here. For steps with many or complex parts, 
  this may require following this process starting back at the beginning for that particular step.
- Test and deploy the script.
- Clean up and/or revise as necessary.



--------------Common Language Features-----------------
data types: 
Many languages include the following data types or analogs to these data types:
- String: This data type consists of individual characters, often laid out sequentially in memory 
- Integer: This data type corresponds to a numeric, whole number, value. The maximum value that can be stored varies based on the platform and/or language. 
- Array/list: Also known as lists in a scripting context, this collection type can store multiple values
- Float: Floating point number — a number with a decimal point attached. This data type can store both very small and very large numbers due to its ability to move the decimal point — thus a floating point.
- Boolean: Value that represents true or false. Often used to control program flow, such as with if/then statements. {}

Variables: 
Variables are a core feature of most scripting languages. This feature allows the storage of a value, and then overwrites this value with a new value,
   
example: number = 1
         number = number + 1
what we type = what we want it to be 
maybe need $number = 1

Input/Output: 
- Console: The console can often be read from or written to.
- File: Scripting languages can often read from or write to files.
- Registry: Scripting languages on Windows may be able to read or write to the registry. This may require the use of external binaries.
- Command Line Arguments: Many scripting languages allow command line arguments to be read, and command line arguments can be supplied to other scripts or applications.
- Network: Scripting languages — either natively or through invoking of external code — can allow a script to connect to other machines via networking to send or receive
           data. This can take the form of Hypertext Transfer Protocol (HTTP) requests, Transmission Control Protocol (TCP) connections, or other lower-level connections. 

Loops/Iteration:
A simple loop might look like this:

for line in lines:
    print(line)

This loop iterates over multiple items

prints the numbers from 0–9. Note that it is still iterating over a set of values. Some languages support separate conditions for the basic for loop:

for x in range(10):
    print(x)


nitialization block ($x = 0) is executed first, and is often intended to be used to initialize a variable to be used in the for loop itself. 
The condition block ($x -lt 10; note that -lt is a less than operator) is an expression that returns a Boolean value (i.e., true or false).
The iteration block ($x++; note that $variable++ is used to increment a value by 1 in this example) is executed after each time this for loop 
is executed, and is intended to be used to change the value of one or more variables being used in the condition block. 

for ($x = 0; $x -lt 10; $x++)
{
    Write-Output $x
}

In addition, some languages have a similar construct, known as do…until,
which behaves in a somewhat similar way. The syntax of this might resemble:

i = 0
while i < 10:
    print(i)
    i = i + 1
some languages have a similar construct, known as do…until

i = 0
do {
    print i
    i++
} until i = 10


This mimics the behavior of the above for loops. While loops can 
also branch based upon more complex behavior, such as;

done = False
while not done:
    # perform work
    done = validate() #method that determines if more work exists


Branching Logic:

Being able to control the flow of the execution of a script or program is a fundamental feature of any scripting language. 
This can take the form of if/then statements, switch statements, etc. These statements alter which line is executed next,
allowing conditions to alter or direct program flow.

 code block entered depends on what x evaluates to — x can either be a Boolean value, or an expression that evaluates to a Boolean value

 if x:
    print("x is true")
 else:
    print("x is false")

if x:
   print("do something with this code path")

switch(x){
    case 1:
        print "x is 1"
    case 2:
        print "x is 2"
    default:
        print "unhandled case"
}














########################## end of day 1 ##############################

















